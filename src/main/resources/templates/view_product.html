<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org"
	th:replace="~{base::layout(~{::section})}">
<head>
<meta charset="UTF-8">
<title>Product Details - SolarTech India</title>
</head>
<body>
	<section>
		<div class="container pt-4 pb-5">
			<div class="card border-0 shadow-sm rounded-3 overflow-hidden">
				<!-- Alert Messages -->
				<div class="px-4 pt-4">
					<th:block th:if="${session.succMsg}">
						<div class="alert alert-success alert-dismissible fade show" role="alert">
							<i class="fas fa-check-circle me-2"></i>[[${session.succMsg}]]
							<button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
							<th:block th:text="${@commnServiceImpl.removeSessionMessage()}"></th:block>
						</div>
					</th:block>

					<th:block th:if="${session.errorMsg}">
						<div class="alert alert-danger alert-dismissible fade show" role="alert">
							<i class="fas fa-exclamation-circle me-2"></i>[[${session.errorMsg}]]
							<button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
							<th:block th:text="${@commnServiceImpl.removeSessionMessage()}"></th:block>
						</div>
					</th:block>
				</div>

				<div class="card-body p-4">
					<div class="row g-4">
						<!-- Product Image Column -->
						<div class="col-lg-5">
							<div class="product-detail-image bg-light p-4 rounded-3 text-center position-relative">
								<th:block th:if="${product.discount > 0}">
									<span class="badge bg-success position-absolute" 
										style="top: 15px; right: 15px; font-size: 0.9rem; padding: 0.5rem;">
										[[${product.discount}]]% OFF
									</span>
								</th:block>
								<span class="badge bg-primary position-absolute" 
									style="top: 15px; left: 15px; font-size: 0.9rem; padding: 0.5rem;">
									<i class="fas fa-flag me-1"></i> Made in India
								</span>
								<img th:src="@{'/img/product_img/'+${product.image}}" 
									class="img-fluid product-detail-img" alt="Product Image"
									width="400" height="350" fetchpriority="high">
							</div>
							
							<!-- Indian Certifications -->
							<div class="certifications mt-3">
								<div class="d-flex justify-content-center flex-wrap gap-2">
									<span class="badge bg-light text-dark p-2 border">BIS Certified</span>
									<span class="badge bg-light text-dark p-2 border">MNRE Approved</span>
									<span class="badge bg-light text-dark p-2 border">IEC Standards</span>
									<span class="badge bg-light text-dark p-2 border">ISO 9001:2015</span>
								</div>
							</div>
						</div>

						<!-- Product Info Column -->
						<div class="col-lg-7">
							<div class="product-info">
								<h2 class="product-title mb-3">[[${product.title}]]</h2>
								
								<!-- Price Section -->
								<div class="product-price mb-4">
									<span class="current-price fs-3 fw-bold text-primary me-2">
										₹[[${product.discountPrice}]]
									</span>
									<span class="original-price fs-5 text-decoration-line-through text-secondary" 
										th:if="${product.discount > 0}">
										₹[[${product.price}]]
									</span>
									<span class="discount-badge badge bg-success ms-2 p-2" 
										th:if="${product.discount > 0}">
										SAVE [[${product.discount}]]%
									</span>
									<div class="mt-1 text-success">
										<small><i class="fas fa-info-circle me-1"></i> Price inclusive of GST</small>
									</div>
								</div>
								
								<!-- Government Subsidy Alert -->
								<div class="subsidy-alert alert alert-info mb-3" th:if="${product.category == 'Residential' || product.category == 'Commercial'}">
									<div class="d-flex align-items-center">
										<div class="flex-shrink-0">
											<i class="fas fa-hand-holding-usd fa-2x me-3"></i>
										</div>
										<div class="flex-grow-1">
											<h6 class="alert-heading mb-1">Government Subsidy Available</h6>
											<p class="mb-0 small">This product is eligible for MNRE subsidy under PM-KUSUM scheme. Get up to 40% off on total system cost. <a href="/financing" class="alert-link">Learn more</a></p>
										</div>
									</div>
								</div>
								
								<!-- Availability -->
								<div class="product-availability mb-3">
									<span class="fw-bold">Availability: </span>
									<th:block th:if="${product.stock > 0}">
										<span class="badge bg-success p-2">
											<i class="fas fa-check-circle me-1"></i> In Stock
										</span>
									</th:block>
									<th:block th:unless="${product.stock > 0}">
										<span class="badge bg-danger p-2">
											<i class="fas fa-times-circle me-1"></i> Out of Stock
										</span>
									</th:block>
								</div>
								
								<!-- Category -->
								<div class="product-category mb-3">
									<span class="fw-bold">Category: </span>
									<span class="badge bg-primary p-2">
										<i class="fas fa-tag me-1"></i>[[${product.category}]]
									</span>
								</div>
								
								<!-- Description -->
								<div class="product-description mb-4">
									<h5 class="mb-2">Description:</h5>
									<p class="text-muted">[[${product.description}]]</p>
								</div>
								
								<!-- Features -->
								<div class="product-features mb-4">
									<div class="row text-center g-0">
										<div class="col-md-3 feature-box p-3">
											<div class="feature-icon text-success mb-2">
												<i class="fas fa-money-bill-wave fa-2x"></i>
											</div>
											<h6>Cash On Delivery</h6>
											<p class="small text-muted mb-0">Pay when received</p>
										</div>
										<div class="col-md-3 feature-box p-3">
											<div class="feature-icon text-danger mb-2">
												<i class="fas fa-undo-alt fa-2x"></i>
											</div>
											<h6>7 Days Return</h6>
											<p class="small text-muted mb-0">Easy returns</p>
										</div>
										<div class="col-md-3 feature-box p-3">
											<div class="feature-icon text-primary mb-2">
												<i class="fas fa-truck-moving fa-2x"></i>
											</div>
											<h6>Free Shipping</h6>
											<p class="small text-muted mb-0">Pan India delivery</p>
										</div>
										<div class="col-md-3 feature-box p-3">
											<div class="feature-icon text-warning mb-2">
												<i class="fas fa-shield-alt fa-2x"></i>
											</div>
											<h6>25 Year Warranty</h6>
											<p class="small text-muted mb-0">Long-term support</p>
										</div>
									</div>
								</div>
								
								<!-- EMI Option -->
								<div class="emi-option mb-4">
									<div class="card border-0 bg-light rounded-3">
										<div class="card-body p-3">
											<h6 class="card-title"><i class="fas fa-credit-card me-2"></i>EMI Options Available</h6>
											<div class="india-accent mb-2"></div>
											<p class="mb-1 small">Start from ₹[[${#numbers.formatInteger(product.discountPrice/12, 0, 'COMMA')}]]/month with No Cost EMI on major banks</p>
											<div class="bank-icons mt-1">
												<img src="https://upload.wikimedia.org/wikipedia/commons/thumb/c/cc/SBI-logo.svg/100px-SBI-logo.svg.png" alt="SBI" width="40" height="20" class="me-1">
												<img src="https://upload.wikimedia.org/wikipedia/commons/thumb/2/28/HDFC_Bank_Logo.svg/100px-HDFC_Bank_Logo.svg.png" alt="HDFC" width="40" height="20" class="me-1">
												<img src="https://upload.wikimedia.org/wikipedia/commons/thumb/7/7b/ICICI_Bank_Logo.svg/100px-ICICI_Bank_Logo.svg.png" alt="ICICI" width="40" height="20" class="me-1">
												<img src="https://upload.wikimedia.org/wikipedia/commons/thumb/e/e3/Axis_bank_logo.svg/100px-Axis_bank_logo.svg.png" alt="Axis" width="40" height="20">
											</div>
										</div>
									</div>
								</div>
								
								<!-- Add to Cart Button -->
								<div class="product-action mt-4">
									<th:block th:if="${product.stock > 0}">
										<th:block th:if="${user == null}">
											<a href="/signin" class="btn btn-primary btn-lg w-100 hover-float">
												<i class="fas fa-sign-in-alt me-2"></i>Login to Add To Cart
											</a>
										</th:block>
										
										<th:block th:unless="${user == null}">
											<form th:action="@{/user/addCart}" method="get" class="w-100">
												<input type="hidden" name="pid" th:value="${product.id}">
												<input type="hidden" name="uid" th:value="${user.id}">
												<button type="submit" class="btn btn-primary btn-lg w-100 hover-float">
													<i class="fas fa-shopping-cart me-2"></i>Add To Cart
												</button>
											</form>
										</th:block>
									</th:block>

									<th:block th:unless="${product.stock > 0}">
										<button class="btn btn-secondary btn-lg w-100" disabled>
											<i class="fas fa-times-circle me-2"></i>Out of Stock
										</button>
									</th:block>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
			
			<!-- Installation Service -->
			<div class="card border-0 shadow-sm rounded-3 overflow-hidden mt-4 mb-4">
				<div class="card-body p-3">
					<div class="d-flex align-items-center">
						<div class="flex-shrink-0 me-3">
							<i class="fas fa-tools fa-2x text-primary"></i>
						</div>
						<div>
							<h5 class="mb-1">Professional Installation Service Available</h5>
							<p class="mb-0 small">Our expert technicians provide installation services across major cities in India. Installation charges apply based on your location.</p>
						</div>
					</div>
				</div>
			</div>
			
			<!-- Back to Products Button -->
			<div class="text-center mt-4">
				<a href="/products" class="btn btn-outline-primary hover-float">
					<i class="fas fa-arrow-left me-2"></i>Back to Products
				</a>
			</div>
		</div>
	</section>
</body>
</html>